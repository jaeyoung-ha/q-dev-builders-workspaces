<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마케팅 분석 결과</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px 20px; text-align: center; border-radius: 10px; margin-bottom: 30px; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .section { background: white; margin: 20px 0; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .section h2 { color: #667eea; font-size: 1.8em; margin-bottom: 20px; border-bottom: 3px solid #667eea; padding-bottom: 10px; }
        .section h3 { color: #764ba2; font-size: 1.4em; margin: 20px 0 15px 0; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
        .card { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea; }
        .card h4 { color: #667eea; margin-bottom: 10px; }
        .highlight { background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 8px; margin: 15px 0; }
        .metric { display: inline-block; background: #667eea; color: white; padding: 5px 15px; border-radius: 20px; margin: 5px; font-weight: bold; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .table th { background: #667eea; color: white; }
        .table tr:hover { background: #f5f5f5; }
        .insights { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); padding: 25px; border-radius: 10px; margin: 20px 0; }
        .recommendations { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 25px; border-radius: 10px; margin: 20px 0; }
        .back-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 30px; border: none; border-radius: 25px; cursor: pointer; font-size: 16px; text-decoration: none; display: inline-block; margin-bottom: 20px; transition: transform 0.3s ease; }
        .back-btn:hover { transform: translateY(-2px); }
        ul { padding-left: 20px; }
        li { margin: 8px 0; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-btn">← 새 파일 분석</a>
        
        <div class="header">
            <h1>📊 마케팅 분석 결과</h1>
            <p>{{ filename }} 파일 분석 (총 {{ data.total_records }}건)</p>
        </div>

        <div class="section">
            <h2>🎯 마케팅 채널 성과</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>채널명</th>
                        <th>총매출</th>
                        <th>거래수</th>
                        <th>평균구매액</th>
                        <th>평균할인율</th>
                    </tr>
                </thead>
                <tbody>
                    {% for channel in data.channels[:10] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ channel.채널 }}</td>
                        <td>{{ "{:,}".format(channel.총매출) }}원</td>
                        <td>{{ channel.거래수 }}건</td>
                        <td>{{ "{:,}".format(channel.평균구매액|int) }}원</td>
                        <td>{{ channel.평균할인율 }}%</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <div class="highlight">
                <h3>🥇 최고 성과 채널</h3>
                <p><strong>{{ data.channels[0].채널 }}</strong>: {{ "{:,}".format(data.channels[0].총매출) }}원 ({{ data.channels[0].거래수 }}건)</p>
            </div>
        </div>

        <div class="section">
            <h2>🛍️ 제품 카테고리 분석</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>카테고리</th>
                        <th>총매출</th>
                        <th>거래수</th>
                        <th>평균구매액</th>
                        <th>총판매수량</th>
                    </tr>
                </thead>
                <tbody>
                    {% for category in data.categories %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ category.카테고리 }}</td>
                        <td>{{ "{:,}".format(category.총매출) }}원</td>
                        <td>{{ category.거래수 }}건</td>
                        <td>{{ "{:,}".format(category.평균구매액|int) }}원</td>
                        <td>{{ category.총판매수량 }}개</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <div class="highlight">
                <h3>💎 최고 매출 카테고리</h3>
                <p><strong>{{ data.categories[0].카테고리 }}</strong>: {{ "{:,}".format(data.categories[0].총매출) }}원</p>
                <p>전체 매출의 {{ "%.1f"|format((data.categories[0].총매출 / (data.categories|sum(attribute='총매출')) * 100)) }}% 차지</p>
            </div>
        </div>

        <div class="section">
            <h2>👥 고객 세그먼트 분석</h2>
            
            <h3>연령대별 매출</h3>
            <div class="grid">
                {% for age_group, sales in data.age_segments.items() %}
                <div class="card">
                    <h4>{{ age_group }}</h4>
                    <p><span class="metric">{{ "{:,}".format(sales) }}원</span></p>
                </div>
                {% endfor %}
            </div>

            <h3>성별 분석</h3>
            <div class="grid">
                {% for gender, stats in data.gender_stats.items() %}
                <div class="card">
                    <h4>{{ gender }}</h4>
                    <p>총매출: <span class="metric">{{ "{:,}".format(stats.총매출) }}원</span></p>
                    <p>거래수: {{ stats.거래수 }}건</p>
                    <p>평균구매액: {{ "{:,}".format((stats.총매출 / stats.거래수)|int) }}원</p>
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="section">
            <h2>🗺️ 지역별 성과 (상위 10개)</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>순위</th>
                        <th>지역</th>
                        <th>총매출</th>
                        <th>거래수</th>
                        <th>평균구매액</th>
                    </tr>
                </thead>
                <tbody>
                    {% for region in data.regions[:10] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ region.지역 }}</td>
                        <td>{{ "{:,}".format(region.총매출) }}원</td>
                        <td>{{ region.거래수 }}건</td>
                        <td>{{ "{:,}".format(region.평균구매액|int) }}원</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="insights">
            <h2>📈 핵심 인사이트</h2>
            <ul>
                <li><strong>최고 성과 마케팅 채널:</strong> {{ data.channels[0].채널 }} ({{ "{:,}".format(data.channels[0].총매출) }}원)</li>
                <li><strong>최고 매출 제품 카테고리:</strong> {{ data.categories[0].카테고리 }} ({{ "{:,}".format(data.categories[0].총매출) }}원)</li>
                <li><strong>최고 매출 지역:</strong> {{ data.regions[0].지역 }} ({{ "{:,}".format(data.regions[0].총매출) }}원)</li>
                <li><strong>최대 구매력 연령대:</strong> 
                    {% set max_age_group = data.age_segments.items()|list|sort(attribute='1', reverse=true)|first %}
                    {{ max_age_group[0] }} ({{ "{:,}".format(max_age_group[1]) }}원)
                </li>
            </ul>
        </div>

        <div class="recommendations">
            <h2>🎯 마케팅 전략 추천</h2>
            <div class="grid">
                <div class="card">
                    <h4>1. 채널 전략</h4>
                    <ul>
                        <li><strong>{{ data.channels[0].채널 }}</strong> 마케팅 예산 집중 투자</li>
                        <li>상위 3개 채널 중심 운영</li>
                        <li>저성과 채널 개선 또는 중단 검토</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>2. 제품 전략</h4>
                    <ul>
                        <li><strong>{{ data.categories[0].카테고리 }}</strong> 라인업 확대</li>
                        <li>고수익 카테고리 프리미엄화</li>
                        <li>저성과 카테고리 번들 상품 개발</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>3. 고객 전략</h4>
                    <ul>
                        {% set max_age_group = data.age_segments.items()|list|sort(attribute='1', reverse=true)|first %}
                        <li><strong>{{ max_age_group[0] }}</strong> 타겟 맞춤 마케팅</li>
                        <li>고구매력 고객층 VIP 프로그램</li>
                        <li>성별별 차별화 전략 수립</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>4. 지역 전략</h4>
                    <ul>
                        <li><strong>{{ data.regions[0].지역 }}</strong> 지역 집중 마케팅</li>
                        <li>고매출 지역 매장 확대</li>
                        <li>지역별 맞춤 프로모션 기획</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
</html>